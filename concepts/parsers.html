
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Parsers &#8212; configpile</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Params (parameters)" href="params.html" />
    <link rel="prev" title="Error handling in configpile" href="errors.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">configpile</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  General information
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Home page
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorial/index.html">
   Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorial/index.html">
     Index
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorial/step1.html">
     Step 1: Simple calculator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorial/step2.html">
     Step 2: Reuse defaults, short flags
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorial/step3.html">
     Step 3: Two positional arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorial/step4.html">
     Step 4: Many positional arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorial/step5.html">
     Step 5: Additional features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorial/step6.html">
     Step 6: Final calculator script
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Concepts
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="overview.html">
     Overview of the process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="errors.html">
     Error handling in
     <code class="docutils literal notranslate">
      <span class="pre">
       configpile
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Parsers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="params.html">
     Params (parameters)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="validation.html">
     Parameter and configuration validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="config.html">
     Configurations
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api.html">
   API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.arg.html">
     arg
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.arg.Arg.html">
       Arg
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.arg.Expander.html">
       Expander
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.arg.Param.html">
       Param
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.collector.html">
     collector
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.collector.Collector.html">
       Collector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.config.html">
     config
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.config.Config.html">
       Config
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.config.IniSection.html">
       IniSection
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.enums.html">
     enums
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.enums.Derived.html">
       Derived
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.enums.ForceCase.html">
       ForceCase
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.enums.Positional.html">
       Positional
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.enums.SpecialAction.html">
       SpecialAction
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.handlers.html">
     handlers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.CLConfigParam.html">
       CLConfigParam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.CLHandler.html">
       CLHandler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.CLInserter.html">
       CLInserter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.CLParam.html">
       CLParam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.CLPos.html">
       CLPos
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.CLSpecialAction.html">
       CLSpecialAction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.CLStdHandler.html">
       CLStdHandler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.KVConfigParam.html">
       KVConfigParam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.KVHandler.html">
       KVHandler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.handlers.KVParam.html">
       KVParam
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.parsers.html">
     parsers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.path_parser.html">
       path_parser
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.int_parser.html">
       int_parser
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.str_parser.html">
       str_parser
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.stripped_str_parser.html">
       stripped_str_parser
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.float_parser.html">
       float_parser
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.ErrorMessageProvider.html">
       ErrorMessageProvider
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html">
       Parser
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.parsers.Predicate.html">
       Predicate
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.processor.html">
     processor
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.processor.IniProcessor.html">
       IniProcessor
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.processor.Processor.html">
       Processor
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.processor.ProcessorFactory.html">
       ProcessorFactory
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.processor.State.html">
       State
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.userr.html">
     userr
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.collect.html">
       collect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.collect_seq.html">
       collect_seq
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.flatMap.html">
       flatMap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.flat_map.html">
       flat_map
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.in_context.html">
       in_context
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.map.html">
       map
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.wrap.html">
       wrap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.Err.html">
       Err
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.Err1.html">
       Err1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.userr.ManyErr.html">
       ManyErr
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../_autosummary/configpile.util.html">
     util
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.assert_never.html">
       assert_never
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.dict_from_multiple_keys.html">
       dict_from_multiple_keys
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.filter_ordered_dict.html">
       filter_ordered_dict
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.filter_ordered_dict_by_value_type.html">
       filter_ordered_dict_by_value_type
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.filter_sequence_by_value_type.html">
       filter_sequence_by_value_type
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.filter_types.html">
       filter_types
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.filter_types_single.html">
       filter_types_single
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../_autosummary/configpile.util.ClassDoc.html">
       ClassDoc
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parser-construction">
   Parser construction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-multiple-string-choices">
     From multiple (string) choices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-multiple-choices-corresponding-to-values">
     From multiple choices corresponding to values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-functions-that-raise-exceptions">
     From functions that raise exceptions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-functions-that-return-a-result">
     From functions that return a result
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-parsy-parsers">
     From parsy parsers
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parser-manipulation">
   Parser manipulation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#handling-optional-parameters">
     Handling optional parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#handling-sequences">
     Handling sequences
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transforming-the-parser-output">
     Transforming the parser output
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation">
   Validation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Parsers</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parser-construction">
   Parser construction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-multiple-string-choices">
     From multiple (string) choices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-multiple-choices-corresponding-to-values">
     From multiple choices corresponding to values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-functions-that-raise-exceptions">
     From functions that raise exceptions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-functions-that-return-a-result">
     From functions that return a result
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-parsy-parsers">
     From parsy parsers
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parser-manipulation">
   Parser manipulation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#handling-optional-parameters">
     Handling optional parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#handling-sequences">
     Handling sequences
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transforming-the-parser-output">
     Transforming the parser output
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation">
   Validation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="parsers">
<span id="concepts-parsers"></span><h1>Parsers<a class="headerlink" href="#parsers" title="Permalink to this headline">¶</a></h1>
<p>Parsers convert strings to values. To create a parser for a new type, you can simply subclass
the <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html#configpile.parsers.Parser" title="configpile.parsers.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">configpile.parsers.Parser</span></code></a> class, not forgetting that this class takes a type
parameter corresponding to the type of the value it parses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configpile</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">FloatParser</span><span class="p">(</span><span class="n">Parser</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Res</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Err</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="n">fp</span> <span class="o">=</span> <span class="n">FloatParser</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;invalid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Err1(msg=&quot;could not convert string to float: &#39;invalid&#39;&quot;, contexts=[])
</pre></div>
</div>
</div>
</div>
<div class="section" id="parser-construction">
<h2>Parser construction<a class="headerlink" href="#parser-construction" title="Permalink to this headline">¶</a></h2>
<p>A parser can also be constructed in several ways.</p>
<div class="section" id="from-multiple-string-choices">
<h3>From multiple (string) choices<a class="headerlink" href="#from-multiple-string-choices" title="Permalink to this headline">¶</a></h3>
<p>If the multiple choices are strings, use <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html#configpile.parsers.Parser.from_choices" title="configpile.parsers.Parser.from_choices"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_choices()</span></code></a>. In
particular, one can force lower or upper case (which we do here).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">=</span> <span class="n">Parser</span><span class="o">.</span><span class="n">from_choices</span><span class="p">([</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">],</span> <span class="n">force_case</span><span class="o">=</span> <span class="n">ForceCase</span><span class="o">.</span><span class="n">LOWER</span><span class="p">)</span>

<span class="n">cp</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Err1(msg=&#39;Value yellow not in choices red,green,blue&#39;, contexts=[])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;blue&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="from-multiple-choices-corresponding-to-values">
<h3>From multiple choices corresponding to values<a class="headerlink" href="#from-multiple-choices-corresponding-to-values" title="Permalink to this headline">¶</a></h3>
<p>When the strings correspond to values, use <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html#configpile.parsers.Parser.from_mapping" title="configpile.parsers.Parser.from_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_mapping()</span></code></a>.
The <code class="docutils literal notranslate"><span class="pre">aliases</span></code> are alternate strings, they are accepted during the parse but not showed in the
usage description.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bp</span> <span class="o">=</span> <span class="n">Parser</span><span class="o">.</span><span class="n">from_mapping</span><span class="p">({</span><span class="s2">&quot;true&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span><span class="n">force_case</span><span class="o">=</span><span class="n">ForceCase</span><span class="o">.</span><span class="n">LOWER</span><span class="p">,</span> <span class="n">aliases</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="from-functions-that-raise-exceptions">
<h3>From functions that raise exceptions<a class="headerlink" href="#from-functions-that-raise-exceptions" title="Permalink to this headline">¶</a></h3>
<p>In this case, the exceptions will be converted to <a class="reference internal" href="../_autosummary/configpile.userr.Err.html#configpile.userr.Err" title="configpile.userr.Err"><code class="xref py py-class docutils literal notranslate"><span class="pre">configpile.userr.Err</span></code></a> instances;
one can specify which exceptions should be caught, and the rest will be propagated.</p>
<p>The static method <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html#configpile.parsers.Parser.from_function_that_raises" title="configpile.parsers.Parser.from_function_that_raises"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_function_that_raises()</span></code></a> is useful for Python
code coming from standard or external libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp1</span> <span class="o">=</span> <span class="n">Parser</span><span class="o">.</span><span class="n">from_function_that_raises</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp1</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp1</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;invalid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Err1(msg=&quot;Error &#39;could not convert string to float: &#39;invalid&#39;&#39; in &#39;invalid&#39;&quot;, contexts=[])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="from-functions-that-return-a-result">
<h3>From functions that return a result<a class="headerlink" href="#from-functions-that-return-a-result" title="Permalink to this headline">¶</a></h3>
<p>One does not need the big ceremonial of constructing a <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html#configpile.parsers.Parser" title="configpile.parsers.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">configpile.parsers.Parser</span></code></a> instance
as only one method needs to be implemented.</p>
<p>The static method <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html#configpile.parsers.Parser.from_function" title="configpile.parsers.Parser.from_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configpile.parsers.Parser.from_function()</span></code></a> is useful for functions that
you will implement yourself: those functions take a string and return a
<a class="reference internal" href="../_autosummary/configpile.userr.html#configpile.userr.Res" title="configpile.userr.Res"><code class="xref py py-data docutils literal notranslate"><span class="pre">configpile.userr.Res</span></code></a>, as discussed in <a class="reference internal" href="errors.html#concepts-errors"><span class="std std-ref">Error handling in configpile</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_fun</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Res</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Err</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="n">fp2</span> <span class="o">=</span> <span class="n">Parser</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span><span class="n">parse_fun</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp2</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp2</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;invalid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Err1(msg=&quot;could not convert string to float: &#39;invalid&#39;&quot;, contexts=[])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="from-parsy-parsers">
<h3>From <a class="reference external" href="https://github.com/python-parsy/parsy">parsy</a> parsers<a class="headerlink" href="#from-parsy-parsers" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">parsy</span></code> is a parser combinator library, useful to parse more involved expressions.</p>
<p>Here is how you would use this library. Note that <code class="docutils literal notranslate"><span class="pre">configpile</span></code> has <code class="docutils literal notranslate"><span class="pre">parsy</span></code> as an optional
dependency, so that every <code class="docutils literal notranslate"><span class="pre">configpile</span></code> user is not forced to have <code class="docutils literal notranslate"><span class="pre">parsy</span></code> as a dependency.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">parsy</span></code> does not support <a class="reference external" href="https://peps.python.org/pep-0484/">type hints</a>, so one needs
to provide the type as a first argument to <a class="reference internal" href="../_autosummary/configpile.parsers.Parser.html#configpile.parsers.Parser.from_parsy_parser" title="configpile.parsers.Parser.from_parsy_parser"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_parsy_parser()</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">parsy</span>
<span class="n">int_parsy_parser</span> <span class="o">=</span> <span class="n">parsy</span><span class="o">.</span><span class="n">regex</span><span class="p">(</span><span class="s1">&#39;[0-9]+&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ip</span><span class="p">:</span> <span class="n">Parser</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parser</span><span class="o">.</span><span class="n">from_parsy_parser</span><span class="p">(</span><span class="n">int_parsy_parser</span><span class="p">)</span>
<span class="n">ip</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;1234&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1234
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="parser-manipulation">
<h2>Parser manipulation<a class="headerlink" href="#parser-manipulation" title="Permalink to this headline">¶</a></h2>
<p>Parsers can be adapted as to change their return value, or even modify the parsing behavior.</p>
<div class="section" id="handling-optional-parameters">
<h3>Handling optional parameters<a class="headerlink" href="#handling-optional-parameters" title="Permalink to this headline">¶</a></h3>
<p>Here, we mean optional in the sense of possibly having a <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> value. We take, for example,
our <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> parser, and make it optional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="n">fp_opt</span><span class="p">:</span> <span class="n">Parser</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">empty_means_none</span><span class="p">()</span>

<span class="n">fp_opt</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp_opt</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;3.14&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.14
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="handling-sequences">
<h3>Handling sequences<a class="headerlink" href="#handling-sequences" title="Permalink to this headline">¶</a></h3>
<p>One can parse sequences of values. Note that the pattern we show below is very crude, and
appropriate only when the separator is never part of the strings representing the values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp_seq</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">separated_by</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">fp_seq</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;1,2,3,4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.0, 2.0, 3.0, 4.0]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transforming-the-parser-output">
<h3>Transforming the parser output<a class="headerlink" href="#transforming-the-parser-output" title="Permalink to this headline">¶</a></h3>
<p>One can map the result of a parser through a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rounded_fp</span><span class="p">:</span> <span class="n">Parser</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">rounded_fp</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;1.23&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="validation.html#concepts-validation"><span class="std std-ref">Parameter and configuration validation</span></a>.</p>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="errors.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Error handling in <code class="docutils literal notranslate"><span class="pre">configpile</span></code></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="params.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Params (parameters)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
        &copy; Copyright .<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>